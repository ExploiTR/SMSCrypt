package app.exploitr.sec.scrypt.security;

import android.security.keystore.KeyProperties;
import android.security.keystore.KeyProtection;

import java.io.UnsupportedEncodingException;
import java.security.KeyStore;
import java.security.KeyStoreException;
import java.security.NoSuchAlgorithmException;

import app.exploitr.sec.scrypt.contacts.ContactModel;

public class Security {

    public static void storePassword(ContactModel model, String password) {
        try {
            KeyStore keyStore = KeyStore.getInstance("AndroidKeyStore");
            keyStore.setEntry(
                    "MAST3R_K3Y",
                    new KeyStore.SecretKeyEntry(AESUtil.generateKey(password)),
                    new KeyProtection.Builder(KeyProperties.PURPOSE_ENCRYPT | KeyProperties.PURPOSE_DECRYPT)
                            .setBlockModes(KeyProperties.BLOCK_MODE_CBC)
                            .setEncryptionPaddings(KeyProperties.ENCRYPTION_PADDING_PKCS7)
                            .build());
        } catch (KeyStoreException | UnsupportedEncodingException | NoSuchAlgorithmException e) {
            e.printStackTrace();
        }
    }
}
